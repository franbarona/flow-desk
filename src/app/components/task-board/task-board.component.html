<!-- Main container -->
<div class="h-full w-full text-neutral-50">
  <!-- Board -->
  <div
    class="h-full w-full flex flex-col md:flex-row justify-center gap-10 overflow-auto px-12 pb-12"
  >
    <!-- Columns -->
    @for (column of columns; track $index) {
    <div class="flex-1 shrink-0">
      <!-- Column Header -->
      <div class="mb-3 flex items-center justify-between">
        <div class="flex items-center justify-start gap-2">
          <h3 class="font-medium capitalize text-neutral-500">
            {{ column.title }}
          </h3>
          <span class="rounded text-sm text-neutral-400">
            {{ getFilteredTasks(column.id).length }}
          </span>
        </div>
        <div class="text-neutral-500">
          <app-icon [icon]="'more_vert'" />
        </div>
      </div>

      <!-- Column Content -->
      <div
        class="h-full w-full transition-colors"
        [ngClass]="{
          'bg-amber-100/30': activeColumn === column.id,
          'bg-amber-100/0': activeColumn !== column.id
        }"
        (dragover)="onDragOver($event, column.id)"
        (dragleave)="onDragLeave(column.id)"
        (drop)="onDrop($event, column.id)"
      >
        <!-- Tasks -->
        @for (task of getFilteredTasks(column.id); track $index) {
        <ng-container>
          <!-- Drop Indicator -->
          <div
            class="my-1 h-0.5 w-[90%] bg-lime-300 opacity-0 transition-opacity ease-in-out duration-50 mx-auto"
            [attr.data-before]="task.id"
            [attr.data-column]="column.id"
          ></div>

          <div class="mb-2" [attr.data-task-id]="task.id">
            <!-- Card -->
            <div
              id="kanban-section"
              draggable="true"
              (dragstart)="onDragStart($event, task)"
              (click)="openTaskModal(task)"
              class="cursor-grab rounded-xl shadow-xs bg-white p-3 active:cursor-grabbing transition-all duration-200 hover:shadow-lg hover:scale-[1.02] hover:cursor-pointer group"
            >
              <app-task-card [task]="task"></app-task-card>
            </div>
          </div>
        </ng-container>
        }

        <!-- Final Drop Indicator -->
        <div
          class="my-1 h-0.5 w-[90%] bg-lime-300 opacity-0 transition-opacity ease-in-out duration-50 mx-auto"
          [attr.data-before]="-1"
          [attr.data-column]="column.id"
        ></div>
      </div>
    </div>
    }

    <!-- Delete -->
    <div class="hidden lg:block fixed bottom-5 right-5 bg-white h-20 w-20 group">
      <div class="absolute z-10 h-full w-full shrink-0 grid place-content-center">
        @if (activeDeleteForever) {
        <app-icon [icon]="'delete_forever'" [size]="30" class="animate-ping text-red"></app-icon>
        }
      </div>
      <div
        class="absolute z-20 grid h-full w-full shrink-0 place-content-center rounded border text-3xl transition-colors select-none"
        [ngClass]="{
          'border-red-800 bg-red-800/20 text-red-500': activeDeleteForever,
          'border-neutral-500 bg-neutral-500/20 text-neutral-500': !activeDeleteForever
        }"
        (dragover)="onDragOver($event)"
        (dragleave)="onDragLeave()"
        (drop)="onDrop($event)"
      >
        @if (!activeDeleteForever) {
        <app-icon [icon]="'delete'" [size]="30"></app-icon>
        }
      </div>
    </div>
  </div>
</div>
